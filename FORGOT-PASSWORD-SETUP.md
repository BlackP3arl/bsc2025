# Forgot Password Setup Guide

## Overview

This guide covers the complete setup of the forgot password functionality for the MTCC BSC application.

## Features Implemented

### 1. Forgot Password Modal
- Accessible from the login page
- Email validation
- Success/error feedback
- Professional UI with MTCC branding

### 2. Password Reset Page
- Secure token validation
- Strong password requirements
- Confirmation matching
- Auto-redirect after success

### 3. Email Integration
- Supabase email service
- Custom redirect URLs
- Professional email templates

## Supabase Configuration

### 1. Enable Email Auth

In your Supabase Dashboard:

1. Go to **Authentication** â†’ **Settings**
2. Ensure **Enable email confirmations** is turned ON
3. Set **Site URL** to your domain (e.g., `https://your-domain.netlify.app`)

### 2. Configure Email Templates

Navigate to **Authentication** â†’ **Email Templates** â†’ **Reset Password**:

**Subject Line:**
```
Reset your password for MTCC BSC
```

**Email Body (HTML):**
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Your Password</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .logo { width: 80px; height: 80px; background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); color: white; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; margin-bottom: 20px; }
        .button { display: inline-block; padding: 15px 30px; background: #1e40af; color: white; text-decoration: none; border-radius: 8px; font-weight: bold; margin: 20px 0; }
        .footer { text-align: center; font-size: 12px; color: #666; margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">M</div>
            <h1>MTCC Balanced Scorecard</h1>
            <h2>Password Reset Request</h2>
        </div>
        
        <p>Hi there,</p>
        
        <p>We received a request to reset your password for your MTCC Balanced Scorecard account.</p>
        
        <p>Click the button below to reset your password:</p>
        
        <div style="text-align: center;">
            <a href="{{ .ConfirmationURL }}" class="button">Reset Password</a>
        </div>
        
        <p>If the button doesn't work, you can copy and paste this link into your browser:</p>
        <p style="word-break: break-all; color: #1e40af;">{{ .ConfirmationURL }}</p>
        
        <p><strong>Important:</strong></p>
        <ul>
            <li>This link will expire in 24 hours</li>
            <li>If you didn't request this reset, you can safely ignore this email</li>
            <li>Your password won't change until you create a new one</li>
        </ul>
        
        <div class="footer">
            <p>This email was sent by MTCC Balanced Scorecard System</p>
            <p>Maldives Transport and Contracting Company Plc</p>
        </div>
    </div>
</body>
</html>
```

### 3. URL Configuration

Set the **Redirect URL** in the email template to:
```
{{ .SiteURL }}/reset-password
```

## Password Requirements

The system enforces strong passwords with the following requirements:

- **Minimum Length**: 8 characters
- **Uppercase**: At least one uppercase letter (A-Z)
- **Lowercase**: At least one lowercase letter (a-z)
- **Numbers**: At least one digit (0-9)
- **Confirmation**: Must match the password field

## User Flow

### 1. Request Reset
1. User clicks "Forgot your password?" on login page
2. Modal opens with email input field
3. User enters email and clicks "Send Reset Link"
4. System sends email via Supabase
5. Success message displays

### 2. Reset Password
1. User receives email with reset link
2. Clicks link to navigate to `/reset-password`
3. Page validates the token from URL parameters
4. User enters new password with confirmation
5. Password is updated in Supabase Auth
6. User is redirected to login page

## Security Features

### 1. Token Validation
- Secure tokens generated by Supabase
- Automatic expiration (24 hours)
- One-time use tokens

### 2. Password Strength
- Client-side validation
- Real-time feedback
- Server-side enforcement

### 3. Rate Limiting
- Supabase provides built-in rate limiting
- Prevents spam reset requests

## Testing the Implementation

### Local Testing

1. **Start Development Server**:
   ```bash
   npm run dev
   ```

2. **Test Password Reset Flow**:
   - Navigate to `/login`
   - Click "Forgot your password?"
   - Enter a valid email address
   - Check email for reset link
   - Follow link to reset password

### Production Testing

1. **Deploy Application**:
   ```bash
   npm run build
   netlify deploy --prod
   ```

2. **Test Email Delivery**:
   - Ensure Supabase email settings are configured
   - Test with real email addresses
   - Verify link redirection works correctly

## Troubleshooting

### Common Issues

1. **Email Not Received**:
   - Check spam/junk folder
   - Verify email address is correct
   - Check Supabase email settings
   - Ensure email templates are configured

2. **Reset Link Invalid**:
   - Link may have expired (24 hours)
   - URL parameters missing or corrupted
   - Site URL configuration incorrect in Supabase

3. **Password Reset Fails**:
   - Token may be expired or invalid
   - Password doesn't meet requirements
   - Network connectivity issues

### Debug Steps

1. **Check Supabase Logs**:
   - Go to Supabase Dashboard â†’ Logs
   - Look for auth-related errors

2. **Browser Console**:
   - Check for JavaScript errors
   - Verify network requests

3. **Email Template Testing**:
   - Send test emails from Supabase dashboard
   - Verify template rendering

## Implementation Status

âœ… **Completed Features**:
- Forgot password modal component
- Password reset page with validation
- Email integration via Supabase
- Strong password requirements
- Security token validation
- Professional email templates
- Complete user flow

ðŸ”§ **Configuration Required**:
- Supabase email template setup
- Site URL configuration
- Email provider settings (if using custom SMTP)

## Support

For technical issues:
1. Check Supabase dashboard logs
2. Verify email template configuration
3. Test with different email providers
4. Contact development team for assistance

---

**Last Updated**: [Current Date]
**Version**: 1.0
**Status**: âœ… Ready for deployment